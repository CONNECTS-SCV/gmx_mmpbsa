# Category 2: Stability Calculation
# 단일 분자의 안정성 계산 (결합 파트너 없음)

calculation_type: stability

################################################################################
# Input Files (입력 파일) - REQUIRED (필수)
################################################################################
input_files:
  # ========== 필수 입력 파일 (5개) ==========
  # 주의: stability 계산은 단일 분자만 사용 (ligand_group = 0)

  # 1. Complex Structure (분자 구조 파일) - REQUIRED
  complex_structure: "/home/connects_md/MODEL/gmx_mmpbsa_workflow/example/step5_production.tpr"
  # TPR 또는 PDB 형식   # 단일 분자 (단백질, RNA, DNA 등)의 구조 파일

  # 2. Complex Trajectory (분자 궤적 파일) - REQUIRED
  complex_trajectory: "/home/connects_md/MODEL/gmx_mmpbsa_workflow/example/fit.xtc"
  # XTC 또는 TRR 형식  # 단일 분자의 MD 궤적 파일

  # 3. Complex Topology (분자 토폴로지 파일) - REQUIRED for CHARMM
  complex_topology: "/home/connects_md/MODEL/gmx_mmpbsa_workflow/example/topol.top"
  # TOP 형식   # CHARMM36m 역장 사용시 반드시 필요!


  # 4. Receptor Group (분자 그룹 번호) - REQUIRED
  receptor_group: 1
  # Index 파일의 그룹 번호 (정수)  # gmx make_ndx -f protein.tpr 로 확인

  # 5. Ligand Group (리간드 그룹 번호) - REQUIRED
  ligand_group: 13
  # *** 중요: stability 계산에서도 리간드 그룹 지정 필요 ***
  # 실제로는 complex만 분석하고 receptor/ligand 분리는 무시됩니다

  # ========== 선택 파일 (권장) ==========

  # Complex Index (인덱스 파일) - Optional
  complex_index: "/home/connects_md/MODEL/gmx_mmpbsa_workflow/example/index.ndx"
  # NDX 형식  # 그룹 정의 파일 (생략시 자동 생성)

  # Reference Structure (참조 구조) - Optional but RECOMMENDED
  reference_structure: ""
  # 올바른 잔기 번호를 가진 완전한 구조

################################################################################
# Execution Options (실행 옵션)
################################################################################
execution:
  # MPI 병렬화 사용 여부
  mpi: true
  # true = MPI로 병렬 실행 (빠름)  # false = 직렬 실행

  # 사용할 CPU 코어 수
  cores: 16
  # MPI 사용시 병렬 코어 개수

################################################################################
# Solvent Model Selection (용매 모델 선택)
################################################################################
solvent_model:
  # 용매 모델 방법
  method: gb
  # gb = Generalized Born (빠름, 일반적 사용)
  # pb = Poisson-Boltzmann (정확함, 느림)
  # 3drism = 3D-RISM (가장 정확, 매우 느림)

  # ===== GB 전용 옵션 (method=gb일 때만) =====
  gb_model: 8
  # GB 모델 선택 (igb 값):
  # 1 = HCT, 2 = OBC1, 5 = OBC2, 7 = GBneck, 8 = GBneck2 (권장!)

  # ===== PB 전용 옵션 (method=pb일 때만) =====
  pb_solver: 1
  # 1 = linear (빠름), 2 = nonlinear (정확)

  # ===== 3D-RISM 전용 옵션 (method=3drism일 때만) =====
  rism_closure: kh
  # kh, hnc, psen

################################################################################
# Trajectory Mode (궤적 모드)
################################################################################
trajectory:
  mode: single
  # stability 계산은 항상 single 모드

################################################################################
# Optional: Decomposition Analysis (선택: 에너지 분해 분석)
################################################################################
decomposition:
  # 에너지 분해 활성화
  enabled: true
  # true = 잔기별 에너지 기여도 계산  # false = 에너지 분해 생략

  # 분해 타입
  type: per_residue
  # per_residue = 잔기별 분해 (어떤 잔기가 중요한지)  # pairwise = 쌍별 분해 (잔기-잔기 상호작용)

  # 분해 방법 (idecomp)
  idecomp: 2
  # 1 = per-residue (1-4 항 제외)
  # 2 = per-residue (1-4 항 포함) ← 권장
  # 3 = pairwise (1-4 항 제외)
  # 4 = pairwise (1-4 항 포함)

  # CSV 형식으로 출력
  csv_format: true
  # true = CSV 파일 생성 (엑셀에서 열기 쉬움)  # false = 텍스트 출력만

  # 출력할 잔기 선택
  print_res: "within 6"
  # "within X" = 리간드 X Å 이내 잔기
  # "1-50" = 잔기 1번부터 50번
  # "1,5,10-20" = 특정 잔기들


################################################################################
# General Settings (일반 설정)
################################################################################
general:
  # 시작 프레임
  startframe: 1

  # 끝 프레임
  endframe: 100
  # 큰 숫자 = 모든 프레임 사용

  # 프레임 간격
  interval: 1
  # 1 = 모든 프레임, 10 = 10개 중 1개

  # Force Field (역장)
  forcefields: CHARMM36m

  # 온도 (K)
  temperature: 298.15

  # 염 농도 (M)
  salt_concentration: 0.15

  # 임시 파일 보관
  keep_files: 0

  # 출력 상세도
  verbose: 1

################################################################################
# Output Files (출력 파일 옵션)
################################################################################
output:
  # 프레임별 에너지 CSV 출력
  energy_csv: "energy_per_frame.csv"
  # CSV 파일로 각 프레임의 에너지 값 저장
  # 시각화 및 상세 분석에 필수!
  # 예: "energies.csv" 또는 "" (비활성화)

  # 분해 분석 CSV 출력 (decomposition이 활성화된 경우)
  decomp_csv: "decomp_per_frame.csv"
  # 잔기별 에너지 분해를 CSV로 저장
  # 예: "decomp.csv" 또는 "" (비활성화)

################################################################################
# Advanced Options (고급 옵션)
################################################################################
advanced:
  surften: 0.0072
  surfoff: 0.0
  intdiel: 1.0
  extdiel: 80.0
  fillratio: 4.0
  scale: 2.0

